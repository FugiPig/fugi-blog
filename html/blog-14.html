<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Zhang San's Blog Website</title>
        <link rel="stylesheet" href="mystyle.css">
    </head>
    <body>
        <big><h1 class="title-h">张三的博客</h1></big>
        <hr width="300">
        <h2 class="title-h">Zhang San's Blog</h4>
        <h2 class="title-h">当前: 对特殊性质下树上DP时间复杂度为O(n^2)证明.md</h2>
        <h2 class="title-h">分类:<a style="display: inline;" href="/fugi-blog/html/node-1.html">-Blog</a><a style="display: inline;" href="/fugi-blog/html/node-8.html">-规划</a><br></h2>
        <span class="blog-text"><h1>0012: 对特殊性质下树上DP时间复杂度为<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x1D6E9;</mi><mo stretchy="false">&#x00028;</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">&#x00029;</mo></mrow></math>的证明</h1>
<p>本篇为动态规划系列第 1 篇, 关于本系列详见<a href="https://www.luogu.com.cn/blog/fugi-tech/post-0000-bo-ke-mu-lu">0000: 博客目录</a>.</p>
<h2>引理12.1</h2>
<p>在树上DP中, 设以点 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>i</mi></mrow></math> 为根的子树为 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>i</mi></msub></mrow></math>. 若点 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>u</mi></mrow></math> 有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>k</mi></mrow></math> 个儿子, 分别为 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>&#x0002C;</mo><msub><mi>v</mi><mn>2</mn></msub><mo>&#x0002C;</mo><mo>&#x0002E;</mo><mo>&#x0002E;</mo><mo>&#x0002C;</mo><msub><mi>v</mi><mi>k</mi></msub></mrow></math>. 如果要将第 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>i</mi></mrow></math> 个儿子 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></math> 转移到 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>u</mi></mrow></math> 需要的枚举次数为<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mstyle displaystyle="true" scriptlevel="0"><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></msub><mo stretchy="false">&#x0007C;</mo><mi>&#x000B7;</mi><mo stretchy="false">[</mo><mo stretchy="false">&#x00028;</mo><msubsup><mo>&#x02211;</mo><mrow><mi>j</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>&#x02212;</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>j</mi></msub></mrow></msub><mo stretchy="false">&#x0007C;</mo><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mn>1</mn><mo stretchy="false">]</mo></mstyle></mrow></math>, 且单次转移复杂度为<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x1D6E9;</mi><mo stretchy="false">&#x00028;</mo><mn>1</mn><mo stretchy="false">&#x00029;</mo></mrow></math>, 则树上DP总时间复杂度为 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x1D6E9;</mi><mo stretchy="false">&#x00028;</mo><mfrac><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><mn>2</mn></mfrac><mo stretchy="false">&#x00029;</mo></mrow></math>.</p>
<blockquote>
<p><strong>证明</strong></p>
<p><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>u</mi></mrow></math> 转移的总转移次数为:</p>
<p><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mstyle displaystyle="true" scriptlevel="0"><mrow><mi>&</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>;</mi><msubsup><mo>&#x02211;</mo><mrow><mi>i</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></msub><mo stretchy="false">&#x0007C;</mo><mi>&#x000B7;</mi><mo stretchy="false">[</mo><mo stretchy="false">&#x00028;</mo><msubsup><mo>&#x02211;</mo><mrow><mi>j</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>&#x02212;</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>j</mi></msub></mrow></msub><mo stretchy="false">&#x0007C;</mo><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mn>1</mn><mo stretchy="false">]</mo><mi>\</mi><mo>&#x0003D;</mo><mi>&</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>;</mi><msubsup><mo>&#x02211;</mo><mrow><mi>i</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mi>k</mi></msubsup><msubsup><mo>&#x02211;</mo><mrow><mi>j</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>&#x02212;</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></msub><mo stretchy="false">&#x0007C;</mo><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>j</mi></msub></mrow></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x0002B;</mo><msubsup><mo>&#x02211;</mo><mrow><mi>i</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></msub><mo stretchy="false">&#x0007C;</mo></mrow></mstyle></mrow></math></p>
<p>我们将 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mstyle displaystyle="true" scriptlevel="0"><msubsup><mo>&#x02211;</mo><mrow><mi>i</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mi>k</mi></msubsup><msubsup><mo>&#x02211;</mo><mrow><mi>j</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>&#x02212;</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></msub><mo stretchy="false">&#x0007C;</mo><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>j</mi></msub></mrow></msub><mo stretchy="false">&#x0007C;</mo></mstyle></mrow></math> 项 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x000D7;</mi><mn>2</mn></mrow></math>, 使得任意 2 个儿子的子树的大小相乘 2 次, 从而将上式化为:</p>
<p><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mtext>上式</mtext><mi>&</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>;</mi><mo>&#x0003D;</mo><mfrac><mrow><msubsup><mo>&#x02211;</mo><mrow><mi>i</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></msub><mo stretchy="false">&#x0007C;</mo><mi>&#x000B7;</mi><mo stretchy="false">&#x00028;</mo><msubsup><mo>&#x02211;</mo><mrow><mi>j</mi><mo>&#x0003D;</mo><mn>1</mn><mo>&#x0002C;</mo><mi>j</mi><mo>&#x02260;</mo><mi>i</mi></mrow><mi>k</mi></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>j</mi></msub></mrow></msub><mo stretchy="false">&#x0007C;</mo><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mn>2</mn><msubsup><mo>&#x02211;</mo><mrow><mi>i</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></msub><mo stretchy="false">&#x0007C;</mo></mrow><mrow><mn>2</mn></mrow></mfrac><mi>&#x00026;</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>;</mi><mo>&#x0003D;</mo><mfrac><mrow><msubsup><mo>&#x02211;</mo><mrow><mi>i</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></msub><mo stretchy="false">&#x0007C;</mo><mi>&#x000B7;</mi><mo stretchy="false">&#x00028;</mo><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x02212;</mo><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x0002B;</mo><mn>1</mn><mo stretchy="false">&#x00029;</mo></mrow><mrow><mn>2</mn></mrow></mfrac><mi>&#x00026;</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>;</mi><mo>&#x0003D;</mo><mfrac><mrow><mo stretchy="false">&#x00028;</mo><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x02212;</mo><mn>1</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><mo stretchy="false">&#x0007C;</mo><mo stretchy="false">&#x00029;</mo><mo>&#x02212;</mo><msubsup><mo>&#x02211;</mo><mrow><mi>i</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></msub><msup><mo stretchy="false">&#x0007C;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><msubsup><mo>&#x02211;</mo><mrow><mi>i</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></msub><mo stretchy="false">&#x0007C;</mo></mrow><mrow><mn>2</mn></mrow></mfrac><mi>&#x00026;</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>;</mi><mo>&#x0003D;</mo><mfrac><mrow><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><msup><mo stretchy="false">&#x0007C;</mo><mn>2</mn></msup><mo>&#x02212;</mo><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x02212;</mo><msubsup><mo>&#x02211;</mo><mrow><mi>i</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></msub><msup><mo stretchy="false">&#x0007C;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x02212;</mo><mn>1</mn><mo stretchy="false">&#x00029;</mo></mrow><mrow><mn>2</mn></mrow></mfrac><mi>&#x00026;</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>;</mi><mo>&#x0003D;</mo><mfrac><mrow><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><msup><mo stretchy="false">&#x0007C;</mo><mn>2</mn></msup><mo>&#x02212;</mo><msubsup><mo>&#x02211;</mo><mrow><mi>i</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></msub><msup><mo stretchy="false">&#x0007C;</mo><mn>2</mn></msup><mo>&#x02212;</mo><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac></mrow></mrow></math></p>
<p>所以对于所有点的总枚举次数为(无需向叶子节点转移):</p>
<p><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><msubsup><mo>&#x02211;</mo><mrow><mi>u</mi><mo>&#x0003D;</mo><mn>1</mn><mo>&#x0002C;</mo><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x02260;</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mfrac><mrow><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><msup><mo stretchy="false">&#x0007C;</mo><mn>2</mn></msup><mo>&#x02212;</mo><msubsup><mo>&#x02211;</mo><mrow><mi>i</mi><mo>&#x0003D;</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></msub><msup><mo stretchy="false">&#x0007C;</mo><mn>2</mn></msup><mo>&#x02212;</mo><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac></mrow></mrow></math></p>
<p>对于非叶非根点, 它的子树大小的平方会被抵消, 所以若<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>n</mi><mo>&#x02260;</mo><mn>1</mn></mrow></math>, 则上式可变为:</p>
<p><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mtext>上式</mtext><mi>&</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>;</mi><mo>&#x0003D;</mo><msubsup><mo>&#x02211;</mo><mrow><mi>u</mi><mo>&#x0003D;</mo><mn>1</mn><mo>&#x0002C;</mo><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mi>n</mi></mrow><mi>n</mi></msubsup><mfrac><mrow><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><msup><mo stretchy="false">&#x0007C;</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn></mrow></mfrac><mo>&#x02212;</mo><msubsup><mo>&#x02211;</mo><mrow><mi>u</mi><mo>&#x0003D;</mo><mn>1</mn><mo>&#x0002C;</mo><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></msubsup><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><msup><mo stretchy="false">&#x0007C;</mo><mn>2</mn></msup><mo>&#x02212;</mo><msubsup><mo>&#x02211;</mo><mrow><mi>u</mi><mo>&#x0003D;</mo><mn>1</mn><mo>&#x0002C;</mo><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x02260;</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><mi>&#x00026;</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>;</mi><mo>&#x0003D;</mo><mfrac><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn></mrow></mfrac><mo>&#x02212;</mo><msubsup><mo>&#x02211;</mo><mrow><mi>u</mi><mo>&#x0003D;</mo><mn>1</mn><mo>&#x0002C;</mo><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></msubsup><mn>1</mn><mo>&#x02212;</mo><msubsup><mo>&#x02211;</mo><mrow><mi>u</mi><mo>&#x0003D;</mo><mn>1</mn><mo>&#x0002C;</mo><mo stretchy="false">&#x0007C;</mo><mi>s</mi><mi>u</mi><msub><mi>b</mi><mi>u</mi></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x02260;</mo><mi>n</mi></mrow><mi>n</mi></msubsup><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><mi>&#x00026;</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>;</mi><mi>&</mi><mi>l</mi><mi>t</mi><mi>;</mi><mfrac><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn></mrow></mfrac></mrow></mrow></math></p>
<p>从而证毕.</p>
</blockquote></span>
    </body>
</html>
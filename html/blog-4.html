<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>张三的博客</title>
        <link rel="stylesheet" href="mystyle.css">
    </head>
    <body>
        <big><h1 class="title-h">张三的博客</h1></big>
        <hr width="300">
        <h2 class="title-h">Zhang San's Blog</h4>
        <h2 class="title-h">当前/Current : 图匹配的定义与性质简述.md</h2>
        <h2 class="title-h">分类/Category : <a style="display: inline;" href="/fugi-blog/html/node-1.html">-Blog</a><a style="display: inline;" href="/fugi-blog/html/node-3.html">-图论</a><a style="display: inline;" href="/fugi-blog/html/node-4.html">-图匹配</a><br></h2>
        <div class="blog-text"><h1>0004:   图匹配和增广路的定义与性质简述</h1>
<p>本篇为图匹配系列的第 1 篇, 关于本系列详见<a href="https://www.luogu.com.cn/blog/fugi-tech/post-0000-bo-ke-mu-lu">0000: 博客目录</a>.</p>
<h2>1. 图的匹配</h2>
<p><strong>匹配</strong>, 又称独立边集, 是指一张无向图中不具有公共点的边的集合. 在本篇中我们给出图匹配以及与之有关的增广路 (不是网络流中的增广路) 的相关定义, 也给出增广路定理的相关说明.</p>
<p>在无向图 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi><mo>&#x0003D;</mo><mo stretchy="false">&#x00028;</mo><mi>V</mi><mo>&#x0002C;</mo><mi>E</mi><mo stretchy="false">&#x00029;</mo></mrow></math>中, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>V</mi></mrow></math> 是点集, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>E</mi></mrow></math> 是边集. 我们称 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math> 是 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi></mrow></math> 的一个匹配, 当且仅当 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi><mo>&#x02286;</mo><mi>E</mi></mrow></math> 且 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math> 中的任意两条边均没有公共点. 我们称匹配 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math> 的大小 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>M</mi><mo stretchy="false">&#x0007C;</mo></mrow></math> 为 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math> 中边的数量, 而且有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>M</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x02264;</mo><mfrac><mrow><mo stretchy="false">&#x0007C;</mo><mi>V</mi><mo stretchy="false">&#x0007C;</mo></mrow><mn>2</mn></mfrac></mrow></math> (抽屉原理).</p>
<p>对于边 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x027E8;</mi><mi>u</mi><mo>&#x0002C;</mo><mi>v</mi><mi>&#x027E9;</mi><mo>&#x02208;</mo><mi>M</mi></mrow></math>, 我们称 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x027E8;</mi><mi>u</mi><mo>&#x0002C;</mo><mi>v</mi><mi>&#x027E9;</mi></mrow></math> 为<strong>匹配边</strong>, 反之为<strong>未匹配边</strong>. 我们称点 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>u</mi></mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>v</mi></mrow></math> 为<strong>匹配点</strong>, 反之为<strong>未匹配点</strong>.</p>
<h3>1.1 特殊的匹配</h3>
<ul>
<li><strong>最大匹配(maximum matching or maximum cardinality matching)</strong>: 包含的边的数量最多的匹配. 在一张图上最大匹配可能有不止一个, 但最大匹配的边数是确定的. </li>
</ul>
<p><img alt="" src="https://oi-wiki.org/graph/graph-matching/images/graph-match-2.svg" /></p>
<ul>
<li><strong>最大权匹配(maximum weight matching)</strong>: 带边权图中边权和最大的匹配, 不一定是最大匹配.</li>
</ul>
<p><img alt="" src="https://oi-wiki.org/graph/graph-matching/images/graph-match-3.svg" /></p>
<ul>
<li>极大匹配(maximal matching): 无法再增加匹配边的匹配, 不一定是最大匹配. </li>
</ul>
<p><img alt="" src="https://oi-wiki.org/graph/graph-matching/images/graph-match-1.svg" /></p>
<ul>
<li>最大权最大匹配(maximum weight maximum cardinality matching): 匹配数最多的前提下边权和最大的匹配, 即所有最大匹配中, 边权和最大的匹配. </li>
</ul>
<p><img alt="" src="https://oi-wiki.org/graph/graph-matching/images/graph-match-4.svg" /></p>
<ul>
<li>
<p>完美匹配(perfect matching): 图上所有点都属于匹配. 若图 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi></mrow></math> 为完全图且 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>V</mi><mo stretchy="false">&#x0007C;</mo></mrow></math> 为偶数时, 必然存在完美匹配.</p>
</li>
<li>
<p>近完美匹配(near-perfect matching): 若图的点数为奇数, 且只有一个点不在匹配中. 删除此点后的图称为 factor-critical graph.</p>
</li>
</ul>
<p>### 1.2 二分图的匹配</p>
<p>一张二分图上的匹配称为二分匹配.</p>
<h4>1.2.1 二分图的完美匹配</h4>
<p>设 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi><mo>&#x0003D;</mo><mi>&#x027E8;</mi><msub><mi>V</mi><mn>1</mn></msub><mo>&#x0002C;</mo><msub><mi>V</mi><mn>2</mn></msub><mo>&#x0002C;</mo><mi>E</mi><mi>&#x027E9;</mi></mrow></math> 为二分图, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><msub><mi>V</mi><mn>1</mn></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x02264;</mo><mo stretchy="false">&#x0007C;</mo><msub><mi>V</mi><mn>2</mn></msub><mo stretchy="false">&#x0007C;</mo></mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math>为<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi></mrow></math>中一个最大匹配, 且 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>M</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mo stretchy="false">&#x0007C;</mo><msub><mi>V</mi><mn>1</mn></msub><mo stretchy="false">&#x0007C;</mo></mrow></math>, 则称 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math> 为 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>1</mn></msub></mrow></math> 到 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>2</mn></msub></mrow></math> 的完美匹配. </p>
<h4>定理4.1 霍尔定理 Hall marriage theorem</h4>
<p>设二分图 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi><mo>&#x0003D;</mo><mi>&#x027E8;</mi><msub><mi>V</mi><mn>1</mn></msub><mo>&#x0002C;</mo><msub><mi>V</mi><mn>2</mn></msub><mo>&#x0002C;</mo><mi>E</mi><mi>&#x027E9;</mi></mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><msub><mi>V</mi><mn>1</mn></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x02264;</mo><mo stretchy="false">&#x0007C;</mo><msub><mi>V</mi><mn>2</mn></msub><mo stretchy="false">&#x0007C;</mo></mrow></math>, 则 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi></mrow></math> 中存在 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>1</mn></msub></mrow></math> 到 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>2</mn></msub></mrow></math> 的完美匹配当且仅当对于任意的 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>S</mi><mo>&#x02286;</mo><msub><mi>V</mi><mn>1</mn></msub></mrow></math> , 均有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>S</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x02264;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo></mrow></math>. 其中 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo><mo>&#x0003D;</mo><msub><mo>&#x0222A;</mo><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>&#x02208;</mo><mi>S</mi></mrow></msub><mrow><mi>N</mi><mo stretchy="false">&#x00028;</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">&#x00029;</mo></mrow></mrow></math>  是 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>S</mi></mrow></math> 的邻域, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>N</mi><mo stretchy="false">&#x00028;</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">&#x00029;</mo></mrow></math> 指 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow></math> 的相邻点, 所以有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo><mo>&#x02286;</mo><msub><mi>V</mi><mn>2</mn></msub></mrow></math> (二分图的定义). </p>
<blockquote>
<p><strong>证明</strong></p>
<p>先证必要性: 若对于任意的 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>S</mi><mo>&#x02286;</mo><msub><mi>V</mi><mn>1</mn></msub></mrow></math>, 均有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>S</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x02264;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo></mrow></math>,  则 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi></mrow></math> 中存在 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>1</mn></msub></mrow></math> 到 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>2</mn></msub></mrow></math> 的完美匹配.</p>
<blockquote>
<p>我们使用数学归纳法证明.</p>
<p>对于 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><msub><mi>V</mi><mn>1</mn></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mn>1</mn></mrow></math> 的二分图显然成立.</p>
<p>对于 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><msub><mi>V</mi><mn>1</mn></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mi>n</mi></mrow></math> 的二分图, 我们设所有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><msub><mi>V</mi><mn>1</mn></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x0003C;</mo><mi>n</mi></mrow></math> 的二分图均已被证明. 然后, 我们设点 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>u</mi><mo>&#x02208;</mo><msub><mi>V</mi><mn>1</mn></msub></mrow></math> 与点 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>v</mi><mo>&#x02208;</mo><msub><mi>V</mi><mn>2</mn></msub></mrow></math> 匹配, 也就相当于在 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi></mrow></math> 上删除点 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>u</mi></mrow></math> 和 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>v</mi></mrow></math>, 从而得到新的二分图 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msup><mi>G</mi><mi>&#x02032;</mi></msup><mo>&#x0003D;</mo><mi>&#x027E8;</mi><msub><mi>V</mi><mn>1</mn></msub><mo>&#x02212;</mo><mo stretchy="false">&#x0007B;</mo><mi>u</mi><mo stretchy="false">&#x0007D;</mo><mo>&#x0002C;</mo><msub><mi>V</mi><mn>2</mn></msub><mo>&#x02212;</mo><mo stretchy="false">&#x0007B;</mo><mi>v</mi><mo stretchy="false">&#x0007D;</mo><mo>&#x0002C;</mo><mi>E</mi><mo>&#x02212;</mo><mo stretchy="false">&#x0007B;</mo><mi>&#x027E8;</mi><msup><mi>u</mi><mi>&#x02032;</mi></msup><mo>&#x0002C;</mo><msup><mi>v</mi><mi>&#x02032;</mi></msup><mi>&#x027E9;</mi><mo stretchy="false">&#x0007C;</mo><mi>&#x027E8;</mi><msup><mi>u</mi><mi>&#x02032;</mi></msup><mo>&#x0002C;</mo><msup><mi>v</mi><mi>&#x02032;</mi></msup><mi>&#x027E9;</mi><mo>&#x02208;</mo><mi>E</mi><mo>&#x0002C;</mo><msup><mi>u</mi><mi>&#x02032;</mi></msup><mo>&#x0003D;</mo><mi>u</mi><mtext>或</mtext><msup><mi>v</mi><mi>&#x02032;</mi></msup><mo>&#x0003D;</mo><mi>v</mi><mo stretchy="false">&#x0007D;</mo><mi>&#x027E9;</mi></mrow></math>, 设图 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi></mrow></math> 上点 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>i</mi></mrow></math> 的相邻点为 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msup><mi>N</mi><mi>&#x02032;</mi></msup><mo stretchy="false">&#x00028;</mo><mi>i</mi><mo stretchy="false">&#x00029;</mo></mrow></math>. 我们发现 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><msub><mi>V</mi><mn>1</mn></msub><mo>&#x02212;</mo><mo stretchy="false">&#x0007B;</mo><mi>u</mi><mo stretchy="false">&#x0007D;</mo><mo stretchy="false">&#x0007C;</mo><mo>&#x0003C;</mo><mi>n</mi></mrow></math>, 所以如果我们能证明对于任意的 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>S</mi><mo>&#x02286;</mo><msub><mi>V</mi><mn>1</mn></msub><mo>&#x02212;</mo><mo stretchy="false">&#x0007B;</mo><mi>u</mi><mo stretchy="false">&#x0007D;</mo></mrow></math> 均有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>S</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x02264;</mo><mo stretchy="false">&#x0007C;</mo><msup><mi>N</mi><mi>&#x02032;</mi></msup><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo></mrow></math> 成立, 则霍尔定理的必要性得证.</p>
<p>令 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mstyle displaystyle="true" scriptlevel="0"><mi>D</mi><mo>&#x0003D;</mo><msub><mo>&#x0222A;</mo><mrow><mi>S</mi><mo>&#x02286;</mo><msub><mi>V</mi><mn>1</mn></msub><mo>&#x02212;</mo><mo stretchy="false">&#x0007B;</mo><mi>u</mi><mo stretchy="false">&#x0007D;</mo><mo>&#x0002C;</mo><mo stretchy="false">&#x0007C;</mo><mi>S</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo></mrow></msub><mi>S</mi></mstyle></mrow></math>, 则 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>v</mi></mrow></math> 不能属于 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>D</mi><mo stretchy="false">&#x00029;</mo></mrow></math>, 否则会出现 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>S</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo><mo>&#x0003E;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo><mo>&#x02212;</mo><mo stretchy="false">&#x0007B;</mo><mi>v</mi><mo stretchy="false">&#x0007D;</mo><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mo stretchy="false">&#x0007C;</mo><msup><mi>N</mi><mi>&#x02032;</mi></msup><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo></mrow></math> 的情况. 相反的, 若 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>v</mi><mo>&#x02209;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>D</mi><mo stretchy="false">&#x00029;</mo></mrow></math>, 则对于任意的 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>S</mi><mo>&#x02286;</mo><mi>V</mi></mrow></math> 且 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>v</mi><mo>&#x02208;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo></mrow></math>, 一定有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>S</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x0003C;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo><mo>&#x02212;</mo><mo stretchy="false">&#x0007B;</mo><mi>v</mi><mo stretchy="false">&#x0007D;</mo><mo stretchy="false">&#x0007C;</mo><mo>&#x0002B;</mo><mn>1</mn><mo>&#x021D2;</mo><mo stretchy="false">&#x0007C;</mo><mi>S</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x02264;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo><mo>&#x02212;</mo><mo stretchy="false">&#x0007B;</mo><mi>v</mi><mo stretchy="false">&#x0007D;</mo><mo stretchy="false">&#x0007C;</mo></mrow></math>.</p>
<p>那会不会出现 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>u</mi><mo stretchy="false">&#x00029;</mo><mo>&#x02286;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>D</mi><mo stretchy="false">&#x00029;</mo></mrow></math> 的情况? 我们可以发现一定有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>D</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>D</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo></mrow></math>(见下方引理4.2的证明), 所以若 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>u</mi><mo stretchy="false">&#x00029;</mo><mo>&#x02286;</mo><mi>D</mi></mrow></math>, 则 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>D</mi><mo>&#x0222A;</mo><mo stretchy="false">&#x0007B;</mo><mi>u</mi><mo stretchy="false">&#x0007D;</mo><mo stretchy="false">&#x0007C;</mo><mo>&#x0003E;</mo><mo stretchy="false">&#x0007C;</mo><mi>D</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>D</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>D</mi><mo>&#x0222A;</mo><mo stretchy="false">&#x0007B;</mo><mi>u</mi><mo stretchy="false">&#x0007D;</mo><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo></mrow></math>, 形成矛盾, 从而证毕.</p>
</blockquote>
<p>再证充分性: 若 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi></mrow></math> 中存在 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>1</mn></msub></mrow></math> 到 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>2</mn></msub></mrow></math> 的完美匹配, 则对于任意的 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>S</mi><mo>&#x02286;</mo><msub><mi>V</mi><mn>1</mn></msub></mrow></math>, 均有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>S</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x02264;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo></mrow></math>.</p>
<blockquote>
<p>反证: 设 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi></mrow></math> 中存在 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>1</mn></msub></mrow></math> 到 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>2</mn></msub></mrow></math> 的完美匹配 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math>, 且存在 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>S</mi><mo>&#x02286;</mo><msub><mi>V</mi><mn>1</mn></msub></mrow></math> 有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>S</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x0003E;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo></mrow></math>.</p>
<p>根据反证假设, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math> 中包含 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>S</mi></mrow></math> 中的点的边定然有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>S</mi><mo stretchy="false">&#x0007C;</mo></mrow></math> 条, 而这 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>S</mi><mo stretchy="false">&#x0007C;</mo></mrow></math> 条边的端点都在 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo></mrow></math> 中. 根据鸽巢原理, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo></mrow></math> 中定然有点为匹配中两条以上边的公共端点, 与反证假设矛盾.</p>
</blockquote>
</blockquote>
<h4>引理4.2 张三引理</h4>
<p>对于二分图 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi><mo>&#x0003D;</mo><mi>&#x027E8;</mi><msub><mi>V</mi><mn>1</mn></msub><mo>&#x0002C;</mo><msub><mi>V</mi><mn>2</mn></msub><mo>&#x0002C;</mo><mi>E</mi><mi>&#x027E9;</mi></mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><msub><mi>V</mi><mn>1</mn></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x02264;</mo><mo stretchy="false">&#x0007C;</mo><msub><mi>V</mi><mn>2</mn></msub><mo stretchy="false">&#x0007C;</mo></mrow></math>, 且对于任意的 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>S</mi><mo>&#x02286;</mo><msub><mi>V</mi><mn>1</mn></msub></mrow></math> , 均有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>S</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x02264;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><mi>S</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo></mrow></math>. 则对于 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>S</mi><mn>1</mn></msub><mo>&#x0002C;</mo><msub><mi>S</mi><mn>2</mn></msub><mo>&#x02286;</mo><msub><mi>V</mi><mn>1</mn></msub></mrow></math>, 若 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><msub><mi>S</mi><mn>1</mn></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><msub><mi>S</mi><mn>1</mn></msub><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo></mrow></math> 且 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><msub><mi>S</mi><mn>2</mn></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><msub><mi>S</mi><mn>2</mn></msub><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo></mrow></math>, 则 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><msub><mi>S</mi><mn>1</mn></msub><mo>&#x0222A;</mo><msub><mi>S</mi><mn>2</mn></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><msub><mi>S</mi><mn>1</mn></msub><mo>&#x0222A;</mo><msub><mi>S</mi><mn>2</mn></msub><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo></mrow></math>.</p>
<blockquote>
<p><strong>证明</strong></p>
<p>因为 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><msub><mi>S</mi><mn>1</mn></msub><mo>&#x0222A;</mo><msub><mi>S</mi><mn>2</mn></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x0003D;</mo><mo stretchy="false">&#x0007C;</mo><msub><mi>S</mi><mn>1</mn></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x0002B;</mo><mo stretchy="false">&#x0007C;</mo><msub><mi>S</mi><mn>2</mn></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x02212;</mo><mo stretchy="false">&#x0007C;</mo><msub><mi>S</mi><mn>1</mn></msub><mo>&#x02229;</mo><msub><mi>S</mi><mn>2</mn></msub><mo stretchy="false">&#x0007C;</mo></mrow></math>, 又有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><msub><mi>S</mi><mn>1</mn></msub><mo>&#x0222A;</mo><msub><mi>S</mi><mn>2</mn></msub><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo><mo>&#x02264;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><msub><mi>S</mi><mn>1</mn></msub><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo><mo>&#x0002B;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><msub><mi>S</mi><mn>2</mn></msub><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo><mo>&#x02212;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><msub><mi>S</mi><mn>1</mn></msub><mo>&#x02229;</mo><msub><mi>S</mi><mn>2</mn></msub><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo><mo>&#x02264;</mo><mo stretchy="false">&#x0007C;</mo><msub><mi>S</mi><mn>1</mn></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x0002B;</mo><mo stretchy="false">&#x0007C;</mo><msub><mi>S</mi><mn>2</mn></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x02212;</mo><mo stretchy="false">&#x0007C;</mo><msub><mi>S</mi><mn>1</mn></msub><mo>&#x02229;</mo><msub><mi>S</mi><mn>2</mn></msub><mo stretchy="false">&#x0007C;</mo></mrow></math>, 将式子连起来, 有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><msub><mi>S</mi><mn>1</mn></msub><mo>&#x0222A;</mo><msub><mi>S</mi><mn>2</mn></msub><mo stretchy="false">&#x0007C;</mo><mo>&#x02265;</mo><mo stretchy="false">&#x0007C;</mo><mi>N</mi><mo stretchy="false">&#x00028;</mo><msub><mi>S</mi><mn>1</mn></msub><mo>&#x0222A;</mo><msub><mi>S</mi><mn>2</mn></msub><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo></mrow></math>, 而这个式子只能取等, 得证.</p>
</blockquote>
<h2>2. 匹配的转换</h2>
<h3>2.1 以最大权最大匹配求最大权匹配</h3>
<h4>2.1.1 算法思路</h4>
<p>最大权最大匹配允许负权边的存在(因为要保证匹配数最大), 而最大权匹配不允许(删掉负权边显然可以让权值和更大, 所以若所有边均为负权, 则最大权匹配为 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo>&#x02205;</mo></mrow></math>). 接下来我们引入匹配的完全图性质以进行求解</p>
<h5>性质4.3 匹配的完全图性质</h5>
<p>当图 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi></mrow></math> 为完全图且没有负边权时, 最大权最大匹配<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo>&#x0003D;</mo></mrow></math>最大权匹配. </p>
<blockquote>
<p><strong>证明</strong></p>
<p>因为 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi></mrow></math> 是完全图, 所以任意一个非最大匹配均可以通过增加边变成最大匹配. 而 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi></mrow></math> 又没有负权边, 所以 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi></mrow></math> 的最大权匹配定为最大匹配或删去几条权为 0 边后的最大匹配, 否则一定可以通过增加权非 0 的边以使权值和增加.</p>
</blockquote>
<h4>2.1.2 算法流程</h4>
<p>由于权值为 0 的边对最大权匹配没有影响, 所以我们可以把原图的所有负权边变为零边(反正本来也要将负权边删去), 然后用权为 0 的边将原图补为完全图, 此时用最大权最大匹配求解的结果即为原图的最大权匹配结果.</p>
<p><img alt="" src="https://oi-wiki.org/graph/graph-matching/images/graph-match-5.svg" /></p>
<h3>2.2 以最大权匹配求最大权最大匹配</h3>
<h4>2.2.1 算法思路</h4>
<p>我们首先为原图的所有边加上一个数 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>K</mi></mrow></math>, 使得图上不存在负权边和零边. 再将所有边加上一个足够大的数 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>P</mi></mrow></math>, 消除原权值对匹配的大小的影响, 让匹配数小但原权值和大的匹配劣于匹配数大但原权值和小的匹配.</p>
<h4>2.2.2 算法流程</h4>
<p>令<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>K</mi><mo>&#x0003D;</mo><mo>max</mo><mo stretchy="false">&#x0007B;</mo><mo stretchy="false">&#x0007C;</mo><mi>w</mi><mo stretchy="false">&#x00028;</mo><mi>e</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x0007C;</mo><mi>:</mi><mi>e</mi><mo>&#x02208;</mo><mi>E</mi><mo>&#x0002C;</mo><mi>w</mi><mo stretchy="false">&#x00028;</mo><mi>e</mi><mo stretchy="false">&#x00029;</mo><mo>&#x02264;</mo><mn>0</mn><mo stretchy="false">&#x0007D;</mo><mo>&#x0002B;</mo><mn>1</mn></mrow></math>, 若没有负边权和零边则<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>K</mi><mo>&#x0003D;</mo><mn>0</mn></mrow></math>. 然后令<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>P</mi><mo>&#x0003D;</mo><msub><mo>&#x02211;</mo><mrow><mi>e</mi><mo>&#x02208;</mo><mi>E</mi></mrow></msub><mi>w</mi><mo stretchy="false">&#x00028;</mo><mi>e</mi><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mi>K</mi></mrow></math>, 最后将每条边的权值增加 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>K</mi><mo>&#x0002B;</mo><mi>P</mi></mrow></math>, 此时的最大权匹配结果就对应原图的最大权最大匹配结果.</p>
<p><img alt="" src="https://oi-wiki.org/graph/graph-matching/images/graph-match-6.svg" /></p>
<h2>3. 增广路</h2>
<h3>3.1 增广路定义</h3>
<p>我们称一条由未匹配边和匹配边交错而成的路径为<strong>交错路(Alternating path)</strong>.</p>
<p>我们称一条始于未匹配点且终于未匹配点(不是起始的未匹配点)的交错路为<strong>增广路(Augmenting path)</strong>.</p>
<h3>3.2 增广操作</h3>
<p>我们发现增广路的第一条边和最后一条边均为未匹配边(因为起点和终点均为未匹配点), 又是由未匹配边和匹配边交错而成的, 所以其包含的边数为奇数.</p>
<p>我们可以将增广路上的匹配边和未匹配边反转, 从而使匹配数增加 1, 同时依然是一个合法的匹配(因为只是将增广路的起点和终点变为匹配点), 这个操作被称为<strong>增广(Augment)</strong>, 这是匈牙利算法增加匹配数量的唯一方式. 操作过程如下图:</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/image_hosting/qnj3713p.png" /></p>
<h3>定理4.4 增广路定理 Berge's lemma</h3>
<p>图 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi><mo>&#x0003D;</mo><mo stretchy="false">&#x00028;</mo><mi>V</mi><mo>&#x0002C;</mo><mi>E</mi><mo stretchy="false">&#x00029;</mo></mrow></math> 的匹配 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math> 是最大匹配当且仅当无法找到增广路.</p>
<blockquote>
<p><strong>证明</strong></p>
<p>先证必要性:</p>
<blockquote>
<p>反证: 设 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math> 是图 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi></mrow></math> 的最大匹配, 且存在一条增广路.</p>
<p>我们可以对这条增广路进行增广, 从而使 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math> 的大小增加, 与反正假设矛盾.</p>
</blockquote>
<p>再证充分性:</p>
<blockquote>
<p>反证: 对于匹配 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math> 在图 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>G</mi></mrow></math> 上找不到增广路, 且有一个更大的匹配 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msup><mi>M</mi><mi>&#x02032;</mi></msup></mrow></math>, 有 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>M</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x0003C;</mo><mo stretchy="false">&#x0007C;</mo><msup><mi>M</mi><mi>&#x02032;</mi></msup><mo stretchy="false">&#x0007C;</mo></mrow></math>.</p>
<p>我们构造图 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>H</mi><mo>&#x0003D;</mo><mo stretchy="false">&#x00028;</mo><mi>V</mi><mo>&#x0002C;</mo><mo stretchy="false">&#x00028;</mo><mi>M</mi><mo>&#x0222A;</mo><msup><mi>M</mi><mi>&#x02032;</mi></msup><mo stretchy="false">&#x00029;</mo><mo>&#x02212;</mo><mo stretchy="false">&#x00028;</mo><mi>M</mi><mo>&#x02229;</mo><msup><mi>M</mi><mi>&#x02032;</mi></msup><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00029;</mo></mrow></math>, 即每条边要么属于 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math>, 要么属于 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msup><mi>M</mi><mi>&#x02032;</mi></msup></mrow></math>, 而且每个点的度均小于等于 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>2</mn></mrow></math>.</p>
<p>由于每个点的度均小于等于 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>2</mn></mrow></math>, 所以 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>H</mi></mrow></math> 上的联通块只会有三种情况: 孤立点, 环和链. 如下图:</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/image_hosting/t23ci9mq.png" /></p>
<p>对于环, 我们发现在任意环上都是 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math> 中的边和 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msup><mi>M</mi><mi>&#x02032;</mi></msup></mrow></math> 中的边交替出现, 这是因为每个点只可能最多有一条 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math> 的边和一条 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msup><mi>M</mi><mi>&#x02032;</mi></msup></mrow></math> 中的边,    从而我们发现环上的 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>M</mi></mrow></math> 中边的数量等于 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msup><mi>M</mi><mi>&#x02032;</mi></msup></mrow></math> 中边的数量.</p>
<p>对于链, 由于<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>M</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x0003C;</mo><mo stretchy="false">&#x0007C;</mo><msup><mi>M</mi><mi>&#x02032;</mi></msup><mo stretchy="false">&#x0007C;</mo></mrow></math>, 所以一定会出现至少一条链, 而且链上也是两种边交替出现. 还是因为 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><mi>M</mi><mo stretchy="false">&#x0007C;</mo><mo>&#x0003C;</mo><mo stretchy="false">&#x0007C;</mo><msup><mi>M</mi><mi>&#x02032;</mi></msup><mo stretchy="false">&#x0007C;</mo></mrow></math>, 一定会出现一条首尾均为 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x0007C;</mo><msup><mi>M</mi><mi>&#x02032;</mi></msup><mo stretchy="false">&#x0007C;</mo></mrow></math>中的边的链, 而这条链就是原图上的一条增广路, 与反证假设矛盾, 从而得证.</p>
</blockquote>
</blockquote>
<h3>3.3 利用增广操作求解最大匹配</h3>
<p>根据定理4.4可知我们求最大匹配的核心思路: 枚举所有未匹配点, 找增广路径并增广, 直到找不到增广路径. </p>
<p>事实上, 对于每个点只要枚举一次就好.</p>
<blockquote>
<p><strong>证明</strong></p>
<p>因为增广操作每次只会使得两端的未匹配点变成匹配点, 不会出现增广后有匹配点变成未匹配点的情况, 所以每个点作为未匹配点只需要增广一次. </p>
</blockquote>
<h3>3.4 交错树</h3>
<p>我们将从未匹配点 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>r</mi></mrow></math> 进行 DFS 或 BFS 寻找增广路的过程中产生的树称为交错树, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>r</mi></mrow></math>是交错树的根. </p>
<p>我们称偶点(黑点)为树上深度为偶数的点. 奇点(白点)为树上深度为奇数的点. 下图展示了一个二分图从未匹配点 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>1</mn></mrow></math> 开始寻找增广路时, 形成的以 <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>1</mn></mrow></math> 为根的交错树. </p>
<p><img alt="" src="https://oi-wiki.org/graph/graph-matching/images/augment-3.svg" /><img alt="" src="https://oi-wiki.org/graph/graph-matching/images/augment-4.svg" /></p>
<h2>4. 参考资料</h2>
<ol>
<li><a href="https://oi-wiki.org/graph/graph-matching/graph-match/">图匹配</a> OI-wiki</li>
<li><a href="https://oi-wiki.org/graph/graph-matching/augment/">增广路</a> OI-wiki</li>
<li><a href="https://zhuanlan.zhihu.com/p/661687568">图论学习笔记（4）- 匹配 Matchings</a> 知乎</li>
<li><a href="https://github.com/Wisdommmmmmmm">Wisdommmmmmmm</a> 在参考资料1下的评论</li>
<li><a href="https://blog.csdn.net/qq_39942341/article/details/128867596?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%E5%9B%BE%E5%8C%B9%E9%85%8D%E5%A2%9E%E5%B9%BF%E8%B7%AF%E5%AE%9A%E7%90%86&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-128867596.142^v99^pc_search_result_base2&amp;spm=1018.2226.3001.4187">图匹配学习</a> CSDN博客</li>
</ol></div>
    </body>
</html>